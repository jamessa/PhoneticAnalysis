from pypinyin import pinyin, Style


def xiaohe(c: str):
    sheng ={
        'sh': 'u',
        'ch': 'i',
        'zh': 'v',
    }

    yun = {
        'iu': 'q',
        'ei': 'w',
        'e': 'e',
        'uan': 'r',
        've': 't',
        'ue': 't',
        'un': 'y',
        'u': 'u',
        'i': 'i',
        'uo': 'o',
        'o': 'o',
        'ie': 'p',
        'a': 'a',
        'iong': 's',
        'ong': 's',
        'ai': 'd',
        'en': 'f',
        'eng': 'g',
        'ang': 'h',
        'an': 'j',
        'ing': 'k',
        'uai': 'k',
        'iang': 'l',
        'uang': 'l',
        'ou': 'z',
        'ia': 'x',
        'ua': 'x',
        'ao': 'c',
        'v': 'v',
        'ui': 'v',
        'in': 'b',
        'iao': 'n',
        'ian': 'm',
    }

    if len(c) <= 2:
        return c
    elif c.startswith(('ch', 'zh', 'sh')):
        s, y = c[:2], c[2:]
        return sheng[s] + yun[y]
    else:
        s, y = c[:1], c[1:]
        return s+yun[y]
    return


def daqian(c: str):
    table = {
        'ã„‡': 'a',
        'ã„–': 'b',
        'ã„': 'c',
        'ã„Ž': 'd',
        'ã„': 'e',
        'ã„‘': 'f',
        'ã„•': 'g',
        'ã„˜': 'h',
        'ã„›': 'i',
        'ã„¨': 'j',
        'ã„œ': 'k',
        'ã„ ': 'l',
        'ã„©': 'm',
        'ã„™': 'n',
        'ã„Ÿ': 'o',
        'ã„£': 'p',
        'ã„†': 'q',
        'ã„': 'r',
        'ã„‹': 's',
        'ã„”': 't',
        'ã„§': 'u',
        'ã„’': 'v',
        'ã„Š': 'w',
        'ã„Œ': 'x',
        'ã„—': 'y',
        'ã„ˆ': 'z',
        'ã„…': '1',
        'ã„‰': '2',
        'Ë‡': '3',
        'Ë‹': '4',
        'ã„“': '5',
        'ËŠ': '6',
        'Ë™': '7',
        'ã„š': '8',
        'ã„ž': '9',
        'ã„¢': '0',
        'ã„¦': '-',
        'ã„¤': ';',
        'ã„': ',',
        'ã„¡': '.',
        'ã„¥': '/',
    }

    r = ''
    for p in c:
        r+=table[p]
    return r

def shuangmabopomofo(c):
    table = {
        'ã„…': 'b',
        'ã„†': 'p',
        'ã„‡': 'm',
        'ã„ˆ': 'f',
        'ã„‰': 'd',
        'ã„Š': 't',
        'ã„‹': 'n',
        'ã„Œ': 'l',
        'ã„': 'g',
        'ã„Ž': 'k',
        'ã„': 'h',
        'ã„': 'j',
        'ã„‘': 'q',
        'ã„’': 'x',
        'ã„“': 'a',
        'ã„”': 'v',
        'ã„•': 'o',
        'ã„–': 'r',
        'ã„—': 'w', # z
        'ã„˜': 'c',
        'ã„™': 's',
        'ã„š': 'a',
        'ã„›': 'o',
        'ã„œ': 'e',
        'ã„': 'p',
        'ã„ž': 'h',
        'ã„Ÿ': 'w',
        'ã„ ': 's',
        'ã„¡': 'r',
        'ã„¢': 'k',
        'ã„£': 'd',
        'ã„¤': 'j',
        'ã„¥': 'f',
        'ã„¦': 'l',
        'ã„§': 'i',
        'ã„§ã„š': 'x',
        'ã„§ã„': 'p',
        'ã„§ã„ ': 'n',
        'ã„§ã„¡': 'b',
        'ã„§ã„¢': 'm',
        'ã„§ã„£': 'v',
        'ã„§ã„¤': 'x',
        'ã„§ã„¥': 'g',
        'ã„¨': 'u',
        'ã„¨ã„š': 'x',
        'ã„¨ã„›': 'o',
        'ã„¨ã„ž': 'g',
        'ã„¨ã„Ÿ': 'v',
        'ã„¨ã„¢': 't',
        'ã„¨ã„£': 'z',
        'ã„¨ã„¤': 'c',
        'ã„¨ã„¥': 'l',
        'ã„©': 'y',
        'ã„©ã„': 'q',
        'ã„©ã„¢': 'k',
        'ã„©ã„£': 'd',
        'ã„©ã„¥': 'f',  # l
    }

    fake_yun={
        'ã„“': 'a',
        'ã„”': 'v',
        'ã„•': 'o',
        'ã„–': 'r',
        'ã„—': 'z',
        'ã„˜': 'c',
        'ã„™': 's',
    }
    zero_sheng={
        'ã„§': 'i',
        'ã„¨': 'u',
        'ã„©': 'y',
        'ã„š': 'a',
        'ã„›': 'o',
        'ã„œ': 'e',
        'ã„': 'p',
        'ã„ž': 'h',
        'ã„Ÿ': 'w',
        'ã„ ': 's',
        'ã„¡': 'r',
        'ã„¢': 'k',
        'ã„£': 'd',
        'ã„¤': 'j',
        'ã„¥': 'f',
        'ã„¦': 'l',
    }
    p = c.strip('ËŠË‡Ë‹Ë™')
    if len(p)==1:  # è™›éŸ»æ¯ï¼šã„“ã„”ã„•ã„–ã€€ã„—ã„˜åŽ¶ é€™äº›å¯ä»¥ç¨å­˜çš„è²æ¯ï¼ˆå…¶å¯¦æ˜¯éŸ»æ¯çœç•¥ï¼‰è¦å¤šæ‰“ä¸€å€‹è™›éŸ»æ¯ã€Œã„­ã€åœ¨å¾Œï¼Œã„­æ”¾åœ¨Iéµä¸Šï¼Œç”¨ emoji: ðŸ˜¬ è¡¨ç¤ºï¼Œå› çˆ²ç™¼éŸ³æ™‚å˜´å½¢é¡žä¼¼ã€‚
        if p in fake_yun.keys():
            return 'i'+table[p]
        elif p in zero_sheng.keys():
            return 'e'+table[p]
        else:
            raise ValueError
    else:
        return table[p[:1]]+table[p[1:]]

with open('hsbdmj.txt', 'r') as f:
    for line in f:
        p = pinyin(line, errors='ignore', style=Style.BOPOMOFO)
        for ch in p:
            c = ch[0]
            # print(c, end=' ')
            # print(xiaohe(c), end='')
            # print(daqian(c), end=' ')
            print(shuangmabopomofo(c), end='')